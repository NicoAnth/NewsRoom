<!DOCTYPE html>
<html lang="en">
<head>
    <title>Register</title>
    <link href="/css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
    <link href="/css/style.css" rel="stylesheet" type="text/css" media="all" />
    </style>
    <script type="text/javascript" src="/js/jquery-2.1.4.min.js"></script>
    <!-- //js -->
    <!-- gallery -->
    <link rel="stylesheet" href="/css/lightGallery.css" type="text/css" media="all" />
    <!-- //gallery -->
    <link rel="stylesheet" href="/css/flexslider.css" type="text/css" media="screen" property="" />
    <!-- font-awesome icons -->
    <link rel="stylesheet" href="css/font-awesome.min.css" />
    <link href="http://fonts.googleapis.com/css?family=Cabin+Condensed:400,500,600,700" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>
</head>

<script>

    function getNews() {
    
        fetch('http://newsapi.org/v2/top-headlines?country=us&category=general&apikey=e34c767bd0b34078a7a790f5c0dd9ba5').then((res)=>{
            return res.json()
        }).then((data)=>{
            console.log(data)
            data.articles.forEach(article =>{
                
                //Create article elements
                let div = document.createElement('div');
                let h2 = document.createElement('h2');
                let a = document.createElement('a');
                let description = document.createElement('p');
                let br = document.createElement('br');
                let hr = document.createElement('hr');
                let img = document.createElement('img');
                let date = document.createElement('em');
                let author = document.createElement('p');
                
                //Parse the NewsAPI date
                var dateapi = article.publishedAt.split('T');

                div.setAttribute('class', 'agileinfo_services_grid');
                a.setAttribute('href',article.url);
                a.textContent = article.title;
                a.setAttribute('style','color:black');
                h2.appendChild(a);

                description.setAttribute('style', 'color:black');
                description.textContent=article.description;

                img.setAttribute('src',article.urlToImage);
                img.setAttribute('class','agileinfo_services_grid_right');
                img.setAttribute('style','position: absolute;left: 98%;');
                img.setAttribute('width', '2.3%');
                img.setAttribute('height', '2%');
                
                //Set the article's date
                date.setAttribute('style', 'left: -139px !important; position: absolute;');
                date.textContent = dateapi[0];

                //Get the article's author
                author.textContent = 'By ' + article.author;

                //If img is provided by NewsAPI, append it to the div
                if(article.urlToImage != null){
                    div.appendChild(img);
                }
                div.appendChild(h2);
                div.appendChild(date);
                div.appendChild(description);

                //If author is provided by NewsAPI, append to the div
                if(article.author != null){
                    div.appendChild(author);
                }
                div.appendChild(br);
                div.appendChild(hr);
                document.getElementById("newsList").appendChild(div);
            })
        })
    }
</script>
<body>
    
    <div class="col-md-4 col-md-offset-4 col-mb-2 "style="margin-bottom: 60px;">
        <nav class="navbar navbar-default">
            <h1><a class="navbar-register" href="./index"><span>N</span>ewsRoom</a></h1>
        </nav>
    </div>
    <div class= "col-sm-12" style="margin-left: 20%;">
        <h1>General</h1>
        <hr style="margin-right: 40%;">
    </div>
    <div class="col-md-4 col-md-offset-4 col-mb-2 " id="newsList"></div>
    <script>getNews()</script>

</body>